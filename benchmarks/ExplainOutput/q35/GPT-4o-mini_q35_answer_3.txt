The result of evaluating the expression is `37`.

**Explanation:**

1. `let x = 3` binds `x` to `3`.
2. `let r = ref 1` creates a mutable reference `r` initialized to `1`.
3. The inner `let` computes `y = x * !r = 3 * 1 = 3` and defines `r = ref 5` (shadowing the outer `r`) but does not affect any outer bindings.
4. The function `f` is defined as `fun u -> u + x + y + !r`, where `x = 3`, `y = 3`, and `!r` refers to the inner `r`, which is `5` when accessed.
5. The next line `let x = 2 * !r * x` evaluates to `2 * 5 * 3 = 30`, binding this new `x`.
6. Then `r := 10` changes the value of the outer `r` to `10`.
7. Finally, `f (x * !r)` is called, which computes `f (30 * 10) = f 300`.
8. Inside `f`, the evaluation becomes `300 + 3 + 3 + 5 = 311`.

The final output is `311`.