**Solution: 135**

**Explanation:**

1. `let x = 3`: `x` is set to 3.
2. `let r = ref 1`: `r` is a reference initialized to 1.
3. `let f = ...`: Define `f`. Inside its scope:
    - `y = x * !r = 3 * 1 = 3`
    - A new `r` is declared (`let r = ref 5`), shadowing the outer `r`.
    - `f` is defined as `fun u -> u + x + y + !r`. Here:
        - `x` is 3 (outer context),
        - `y` is 3 (calculated above),
        - `!r` (inner reference) will evaluate to 5.
4. `let x = 2 * !r * x`: Evaluate `x = 2 * !r * x = 2 * 1 * 3 = 6`.
5. `r := 10`: The outer `r` (not inner `r` in `f`) becomes 10.
6. `f (x * !r)`:
    - `x * !r = 6 * 10 = 60`
    - Call `f`:
        - `u = 60`
        - `x = 3`, `y = 3`, `!r = 5`.
        - `u + x + y + !r = 60 + 3 + 3 + 5 = 135`.

Thus, the output is **135**.