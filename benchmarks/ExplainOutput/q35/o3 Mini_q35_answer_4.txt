Solution: 71

Explanation: Initially, x = 3 and r is ref 1, so in f the binding y becomes 3 (3 * 1). Then a new r (ref 5) is created and captured by f along with x = 3 and y = 3. Next, a new x is defined as 2 * !r * 3 = 6 (using the outer r still at 1), and then the outer r is updated to 10. Finally, f is called with x * !r = 6 * 10 = 60; f computes 60 + 3 + 3 + !r (with its own r still 5), yielding 60 + 3 + 3 + 5 = 71.