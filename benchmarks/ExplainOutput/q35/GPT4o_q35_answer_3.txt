**Solution:**  
The result is **96**.

**Explanation:**  
1. `let x = 3` binds `x` to `3`.
2. `let r = ref 1` creates a reference `r` initialized to `1`.
3. `f` is defined as follows:
   - `let y = x * !r` evaluates to `3 * 1 = 3` since `x = 3` and `!r = 1`. So, `y = 3`.
   - Inside `f`, a new `r` is created: `let r = ref 5`.
   - `f` is finally `fun u -> u + x + y + !r`. `x = 3`, `y = 3`, and `!r` (inside `f`) will be evaluated to `5` at function application time.
4. `let x = 2 * !r * x` updates `x`:  
   - `2 * !r * x = 2 * 1 * 3 = 6`. So, global `x = 6`.
5. `r := 10` updates the global `r` to `10`.
6. `f (x * !r)` is evaluated:
   - `x * !r = 6 * 10 = 60`. So, `f` is called with `u = 60`.
   - Inside `f`, `u = 60`, `x = 3`, `y = 3` (captured during `f`'s definition), and `!r = 5` (local `r` inside `f`).
   - `u + x + y + !r = 60 + 3 + 3 + 5 = 96`.