type nat = Z | S of nat
type 'b church = 'b -> ('b -> 'b) -> 'b

let zero : 'b church = fun z s -> z
let one : 'b church = fun z s -> s z

(* Question 1a: Church numeral to integer *)
let to_int (n : int church) : int =
  (* TODO: Implement the function. *)
  n 0 (fun x -> x + 1)

(* Question 1b: Add two church numerals *)
let add (n1 : 'b church) (n2 : 'b church) : 'b church =
  (* TODO: Implement the function. *)
  fun z s -> n1 (n2 z s) s

(* Question 1c: Multiply two church numerals *)
let mult (n1 : 'b church) (n2 : 'b church) : 'b church =
  (* TODO: Implement the function. *)
  fun z s -> n1 z (fun r -> n2 r s)

(* Question 2a: Sum a list of church numerals *)
let sum (l : 'b church list) : 'b church =
  (* TODO: implement sum *)
  List.fold_left add zero l

(* Question 2b: Compute the length of a list as a church numeral *)
let length (l : 'a list) : 'b church =
  (* TODO: implement length *)
  List.fold_left (fun acc _ -> add one acc) zero l