```ocaml
type formula =
  | Variable of string
  | Conjunction of formula * formula
  | Disjunction of formula * formula
  | Negation of formula

module Variable_set = Set.Make (String)
module Variable_map = Map.Make (String)

type truth_assignment = bool Variable_map.t

exception Unassigned_variable of string

exception Unsatisfiable_formula

let collect_variables (formula : formula) : Variable_set.t =
  let rec collect_variables_helper formula acc =
    match formula with
    | Variable x -> Variable_set.add x acc
    | Conjunction (f1, f2) ->
        collect_variables_helper f2 (collect_variables_helper f1 acc)
    | Disjunction (f1, f2) ->
        collect_variables_helper f2 (collect_variables_helper f1 acc)
    | Negation f -> collect_variables_helper f acc
  in
  (* TODO: Implement the function. *)
  collect_variables_helper formula Variable_set.empty

let eval (state : truth_assignment) (formula : formula) : bool =
  let rec eval_helper state formula =
    match formula with
    | Variable x -> (
        match Variable_map.find_opt x state with
        | Some b -> b
        | None -> raise (Unassigned_variable x))
    | Conjunction (f1, f2) -> eval_helper state f1 && eval_helper state f2
    | Disjunction (f1, f2) -> eval_helper state f1 || eval_helper state f2
    | Negation f -> not (eval_helper state f)
  in
  (* TODO: Implement the function. *)
  eval_helper state formula

let find_satisfying_assignment (formula : formula) : truth_assignment =
  let variables = Variable_set.to_list (collect_variables formula) in
  let rec find_assignment assignment vars =
    match vars with
    | [] ->
        if eval assignment formula then assignment else raise Unsatisfiable_formula
    | var :: rest ->
        let true_assignment = Variable_map.add var true assignment in
        try find_assignment true_assignment rest with Unsatisfiable_formula ->
          let false_assignment = Variable_map.add var false assignment in
          find_assignment false_assignment rest
  in
  (* TODO: Implement the function. *)
  try find_assignment Variable_map.empty variables with Unsatisfiable_formula ->
    raise Unsatisfiable_formula
```