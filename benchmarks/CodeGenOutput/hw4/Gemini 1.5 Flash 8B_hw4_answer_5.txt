```OCaml
module Variable_set = Set.Make (String)
module Variable_map = Map.Make (String)

type formula =
  | Variable of string
  | Conjunction of formula * formula
  | Disjunction of formula * formula
  | Negation of formula

type truth_assignment = bool Variable_map.t

exception Unassigned_variable of string
exception Unsatisfiable_formula

let collect_variables (formula : formula) : Variable_set.t =
  let rec aux (f : formula) : Variable_set.t =
    match f with
      | Variable v -> Variable_set.singleton v
      | Conjunction (f1, f2) -> Variable_set.union (aux f1) (aux f2)
      | Disjunction (f1, f2) -> Variable_set.union (aux f1) (aux f2)
      | Negation f1 -> aux f1
  in aux formula

let eval (state : truth_assignment) (formula : formula) : bool =
  let rec aux (f : formula) : bool =
    match f with
      | Variable v ->
        begin
          match Variable_map.find_opt v state with
            | Some b -> b
            | None -> raise (Unassigned_variable v)
        end
      | Conjunction (f1, f2) -> aux f1 && aux f2
      | Disjunction (f1, f2) -> aux f1 || aux f2
      | Negation f1 -> not (aux f1)
  in aux formula

let find_satisfying_assignment (formula : formula) : truth_assignment option =
  let vars = collect_variables formula in
  let rec helper (current_assignment) =
    if Variable_set.is_empty vars then
      if eval current_assignment formula then Some current_assignment
      else None
    else
      let var = Variable_set.min_elt vars in
      let is_true = helper (Variable_map.add var true current_assignment) in
      match is_true with
        | Some a -> Some a
        | None ->
          let is_false = helper (Variable_map.add var false current_assignment) in
          match is_false with
            | Some a -> Some a
            | None -> None
  in
  match helper Variable_map.empty with
        | Some a -> Some a
        | None -> None
```