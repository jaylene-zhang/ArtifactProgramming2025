```ocaml
module Variable_set = Set.Make (String)
module Variable_map = Map.Make (String)

type formula =
  | Variable of string
  | Conjunction of formula * formula
  | Disjunction of formula * formula
  | Negation of formula

type truth_assignment = bool Variable_map.t

exception Unassigned_variable of string
exception Unsatisfiable_formula

let collect_variables (formula : formula) : Variable_set.t =
  let rec aux (formula : formula) : Variable_set.t =
    match formula with
    | Variable v -> Variable_set.singleton v
    | Conjunction (f1, f2) -> Variable_set.union (aux f1) (aux f2)
    | Disjunction (f1, f2) -> Variable_set.union (aux f1) (aux f2)
    | Negation f -> aux f
  in aux formula

let eval (state : truth_assignment) (formula : formula) : bool =
  let rec aux (state : truth_assignment) (formula : formula) : bool =
    match formula with
    | Variable v ->
      begin match Variable_map.find_opt v state with
      | Some b -> b
      | None -> raise (Unassigned_variable v)
      end
    | Conjunction (f1, f2) -> aux state f1 && aux state f2
    | Disjunction (f1, f2) -> aux state f1 || aux state f2
    | Negation f -> not (aux state f)
  in aux state formula

let rec find_satisfying_assignment (formula : formula) : truth_assignment option =
  let vars = collect_variables formula in
  let rec aux (current_assignment : truth_assignment) : truth_assignment option =
    if Variable_set.cardinal current_assignment = Variable_set.cardinal vars then
      if eval current_assignment formula then
        Some current_assignment
      else
        None
    else
      let var = Variable_set.min_elt vars in
      begin match Variable_map.find_opt var current_assignment with
        | Some _ -> aux current_assignment
        | None -> 
          let new_assignment = Variable_map.add var true  current_assignment
          in 
          begin match aux new_assignment with
          | Some a -> Some a
          | None ->
            let new_assignment2 = Variable_map.add var false current_assignment
            in
            begin match aux new_assignment2 with
            | Some a -> Some a
            | None -> None
            end   
          end 
      end
  in match aux Variable_map.empty with
          | Some a -> Some a
          | None -> None

```